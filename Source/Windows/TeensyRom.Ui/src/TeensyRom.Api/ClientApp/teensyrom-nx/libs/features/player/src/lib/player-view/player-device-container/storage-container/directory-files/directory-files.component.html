<div class="directory-files">
  <lib-card-layout>
    @if (directoryContents().isLoading) {
    <p>Loading directory contents...</p>
    } @else if (directoryContents().error) {
    <p class="error">Error: {{ directoryContents().error }}</p>
    } @else if (directoryContents().hasContent) {
    <div class="files-list">
      @for (item of combinedItems(); track item.path) {
      <div 
        class="file-list-item" 
        [attr.data-item-path]="item.path"
        [attr.data-is-playing]="isCurrentlyPlaying(item)"
      >
        @if (isDirectory(item)) {
        <lib-directory-item
          [directoryItem]="item"
          [selected]="isSelected(item)"
          (itemSelected)="onItemSelected($event)"
          (itemDoubleClicked)="onDirectoryDoubleClick($event)"
        >
        </lib-directory-item>
        } @else {
        <lib-file-item
          [fileItem]="item"
          [selected]="isSelected(item)"
          (itemSelected)="onItemSelected($event)"
          (itemDoubleClick)="onFileDoubleClick($event)"
        >
        </lib-file-item>
        }
      </div>
      }
    </div>
    } @else {
    <p>No directory selected or directory is empty.</p>
    }
  </lib-card-layout>
</div>
